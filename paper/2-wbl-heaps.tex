\section{Weight biased leftist heaps}\label{sec:wblh}

A heap is a tree-based data structure used to implement priority queue. Each node in the heap satisfies \textit{priority property}: priority of element at the node is not lower than priority of the children nodes\footnote{I will also refer to children of a node as ``subtrees'' or ``subheaps''.}. Element with the highest priority is stored at the root. Access to it has O(1) complexity.

Weight biased leftist tree \cite{ChoSah96} is a binary tree that satisfies \textit{rank property}: for each node rank of its left child is not smaller than rank of its right child. Rank of a tree is defined as its size (number of nodes). Weight biased leftist tree that satisfies priority property is called a weight biased leftist heap.

\textit{Right spine} of a node is the rightmost path from that node to an empty node. From priority property it follows that right spine of a weight biased leftist heap is an ordered list (in fact, any path from root to a leaf is!). Two weight biased leftist heaps can be merged in O(log~n) time by merging their right spines in the same way one merges ordered lists and then swapping children along the right spine of merged heap to restore rank property \cite{Oka99}. Inserting new element into weight biased leftist heap can be defined as merging existing heap with a newly created singleton heap. Deleting element with the highest priority can be defined as merging children of the root element.

In practice heaps often store elements of some arbitrary type with a priority assigned to them. However this arbitrary elements are completely irrelevant from the verification's point of view and hence they our heaps will story only priorities with no additional elements assigned to them.

I will represent priorities using natural numbers with lower number meaning higher priority. This means that 0 is the highest priority, while the lowest priority is unbounded. This also means that if \texttt{p1 > p2} holds as a relation on natural numbers then p2 is higher priority than p1.